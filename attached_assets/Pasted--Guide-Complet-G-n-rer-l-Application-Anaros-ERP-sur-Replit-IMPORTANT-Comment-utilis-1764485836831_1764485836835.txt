# ğŸš€ Guide Complet : GÃ©nÃ©rer l'Application Anaros ERP sur Replit

## âš ï¸ IMPORTANT : Comment utiliser ce guide

Replit ne peut pas gÃ©nÃ©rer automatiquement une application complÃ¨te, MAIS vous pouvez utiliser **Replit AI** pour crÃ©er l'application progressivement. Voici comment procÃ©der :

---

## ğŸ“‹ Ã‰TAPE 1 : CrÃ©er le Projet sur Replit

1. Allez sur [replit.com](https://replit.com)
2. Cliquez sur **"+ Create Repl"**
3. SÃ©lectionnez **"React + Vite"** comme template
4. Nommez le projet : `anaros-erp`
5. Cliquez sur **Create Repl**

---

## ğŸ¤– Ã‰TAPE 2 : Utiliser Replit AI (Agent)

Une fois le projet crÃ©Ã©, utilisez l'assistant IA de Replit en lui donnant ces prompts **dans l'ordre** :

### Prompt 1 : Configuration Initiale
```
Installe et configure un projet React + TypeScript + Vite avec les dÃ©pendances suivantes :
- @supabase/supabase-js (client Supabase)
- @tanstack/react-query (gestion d'Ã©tat)
- react-router-dom (routing)
- @fullcalendar/react, @fullcalendar/resource-timegrid, @fullcalendar/interaction
- lucide-react (icÃ´nes)
- shadcn/ui (composants UI)
- tailwindcss (styling)

Configure aussi TypeScript, Tailwind CSS et crÃ©e la structure de dossiers suivante :
/src
  /components
    /dashboard
    /calendar
    /clients
    /users
    /services
  /lib
  /hooks
  /types
  /pages
```

### Prompt 2 : Configuration Supabase
```
CrÃ©e un fichier src/lib/supabase.ts qui initialise le client Supabase avec les variables d'environnement VITE_SUPABASE_URL et VITE_SUPABASE_ANON_KEY.

CrÃ©e aussi un fichier .env.example avec ces variables.
```

### Prompt 3 : Types TypeScript
```
CrÃ©e un fichier src/types/database.ts avec les types TypeScript suivants basÃ©s sur notre schÃ©ma Supabase :

- Profile (id, first_name, last_name, role: 'superadmin' | 'admin' | 'reception' | 'staff', color_code)
- ServiceCategory (id, name)
- Service (id, category_id, name, price en DA, duration en minutes)
- StaffSkill (profile_id, category_id)
- Client (id, full_name, phone, notes)
- Appointment (id, created_at, start_time, end_time, client_id, staff_id, service_id, status: 'pending' | 'confirmed' | 'completed' | 'cancelled')
```

### Prompt 4 : SystÃ¨me d'Authentification
```
CrÃ©e un systÃ¨me d'authentification avec Supabase Auth :
- Page de login (src/pages/Login.tsx)
- Contexte d'authentification (src/contexts/AuthContext.tsx)
- Hook useAuth pour accÃ©der au user et logout
- Route protÃ©gÃ©e qui redirige vers /login si non authentifiÃ©
```

### Prompt 5 : Layout Principal
```
CrÃ©e un layout principal (src/components/Layout.tsx) avec :
- Sidebar avec navigation (Dashboard, Agenda, Clients, Services, Utilisateurs)
- Affichage conditionnel des menus selon le rÃ´le (voir tableau des permissions)
- Header avec nom de l'utilisateur et bouton logout
- Responsive (mobile-first)
```

### Prompt 6 : Module Dashboard (Admin)
```
CrÃ©e une page Dashboard (src/pages/Dashboard.tsx) qui affiche :
- KPI Cards : CA du jour/mois/annÃ©e, nombre de RDV
- Tableau "Top EmployÃ©s" (basÃ© sur le CA gÃ©nÃ©rÃ©)
- Tableau "Top Prestations" (services les plus vendus)
- Card "Client DorÃ©" (client ayant le plus dÃ©pensÃ© ce mois)

Utilise React Query pour fetcher les donnÃ©es depuis Supabase.
```

### Prompt 7 : Module Gestion Utilisateurs
```
CrÃ©e une page Users (src/pages/Users.tsx) accessible uniquement aux admins avec :
- Liste des employÃ©s avec avatar, nom, rÃ´le, couleur
- Bouton "Ajouter un employÃ©"
- Modal de crÃ©ation/Ã©dition avec formulaire (nom, prÃ©nom, email, mot de passe, rÃ´le, couleur)
- Section "CompÃ©tences" : checkboxes pour assigner les catÃ©gories de services maÃ®trisÃ©es
- Bouton supprimer avec confirmation
```

### Prompt 8 : Module Clients
```
CrÃ©e une page Clients (src/pages/Clients.tsx) avec :
- Barre de recherche (par nom ou tÃ©lÃ©phone)
- Liste des clients en cards
- Bouton "Nouveau client"
- Modal avec formulaire (nom complet, tÃ©lÃ©phone, email optionnel, notes)
- Vue dÃ©tail client : historique des RDV + total dÃ©pensÃ©
```

### Prompt 9 : Module Services/Prestations
```
CrÃ©e une page Services (src/pages/Services.tsx) avec :
- Liste groupÃ©e par catÃ©gorie (Coiffure, Hammam, Massage, etc.)
- CRUD complet : Ajouter, Modifier, Supprimer
- Formulaire avec : CatÃ©gorie, Nom, Prix (DA), DurÃ©e (minutes)
```

### Prompt 10 : Module Agenda - Vue RÃ©ception
```
CrÃ©e une page Calendar (src/pages/Calendar.tsx) avec FullCalendar en mode "resourceTimeGrid" :
- Les employÃ©s sont affichÃ©s en colonnes horizontales
- Chaque employÃ© a sa couleur (depuis profile.color_code)
- Heures de 9h Ã  20h
- CrÃ©er un RDV :
  1. Clic sur un crÃ©neau
  2. Modal : SÃ©lection Client (autocomplete), SÃ©lection Service
  3. LOGIQUE CLÃ‰E : Filtrer et ne montrer QUE les colonnes des employÃ©s compÃ©tents pour ce service (utiliser staff_skills)
  4. Validation et crÃ©ation
- Afficher les dÃ©tails au clic sur un Ã©vÃ©nement
```

### Prompt 11 : Module Agenda - Vue EmployÃ© (Mobile)
```
CrÃ©e une page MySchedule (src/pages/MySchedule.tsx) pour les employÃ©s :
- Vue liste de LEUR journÃ©e uniquement (filtrÃ© par staff_id)
- Affiche : Heure, Nom du client, Prestation
- Design mobile-first avec grandes cards tactiles
```

### Prompt 12 : SystÃ¨me de Notifications
```
CrÃ©e un systÃ¨me de notifications in-app :
- Composant Toast (src/components/Notifications.tsx)
- Hook useNotifications qui check les RDV Ã  venir dans 10 min
- Polling toutes les 5 minutes ou utilisation de Supabase Realtime
```

---

## ğŸ—„ï¸ Ã‰TAPE 3 : Configuration Supabase

### A. CrÃ©er le projet Supabase
1. Allez sur [supabase.com](https://supabase.com)
2. CrÃ©ez un nouveau projet : `anaros-erp`
3. Notez l'URL et la clÃ© ANON KEY

### B. ExÃ©cuter le script SQL
Allez dans **SQL Editor** et exÃ©cutez ce script :

```sql
-- Table des profils utilisateurs (extension de auth.users)
CREATE TABLE profiles (
  id UUID REFERENCES auth.users PRIMARY KEY,
  first_name TEXT NOT NULL,
  last_name TEXT NOT NULL,
  role TEXT NOT NULL CHECK (role IN ('superadmin', 'admin', 'reception', 'staff')),
  color_code TEXT DEFAULT '#3B82F6',
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- Table des catÃ©gories de services
CREATE TABLE services_categories (
  id SERIAL PRIMARY KEY,
  name TEXT NOT NULL UNIQUE
);

-- Table des services (catalogue)
CREATE TABLE services (
  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
  category_id INTEGER REFERENCES services_categories(id),
  name TEXT NOT NULL,
  price INTEGER NOT NULL, -- Prix en DA
  duration INTEGER NOT NULL, -- DurÃ©e en minutes
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- Table des compÃ©tences staff (qui sait faire quoi)
CREATE TABLE staff_skills (
  profile_id UUID REFERENCES profiles(id) ON DELETE CASCADE,
  category_id INTEGER REFERENCES services_categories(id) ON DELETE CASCADE,
  PRIMARY KEY (profile_id, category_id)
);

-- Table des clients
CREATE TABLE clients (
  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
  full_name TEXT NOT NULL,
  phone TEXT NOT NULL,
  email TEXT,
  notes TEXT,
  created_at TIMESTAMPTZ DEFAULT NOW()
);
CREATE INDEX idx_clients_phone ON clients(phone);

-- Table des rendez-vous
CREATE TABLE appointments (
  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  start_time TIMESTAMPTZ NOT NULL,
  end_time TIMESTAMPTZ NOT NULL,
  client_id UUID REFERENCES clients(id),
  staff_id UUID REFERENCES profiles(id),
  service_id UUID REFERENCES services(id),
  status TEXT DEFAULT 'pending' CHECK (status IN ('pending', 'confirmed', 'completed', 'cancelled'))
);

-- Index pour optimiser les requÃªtes
CREATE INDEX idx_appointments_start_time ON appointments(start_time);
CREATE INDEX idx_appointments_staff_id ON appointments(staff_id);

-- RLS Policies (SÃ©curitÃ©)

-- Profiles
ALTER TABLE profiles ENABLE ROW LEVEL SECURITY;
CREATE POLICY "Profiles visibles par tous les authentifiÃ©s" ON profiles FOR SELECT USING (auth.role() = 'authenticated');
CREATE POLICY "Admins peuvent tout gÃ©rer" ON profiles FOR ALL USING (
  EXISTS (SELECT 1 FROM profiles WHERE id = auth.uid() AND role IN ('superadmin', 'admin'))
);

-- Services
ALTER TABLE services ENABLE ROW LEVEL SECURITY;
CREATE POLICY "Services visibles par tous" ON services FOR SELECT USING (auth.role() = 'authenticated');
CREATE POLICY "Admins gÃ¨rent services" ON services FOR ALL USING (
  EXISTS (SELECT 1 FROM profiles WHERE id = auth.uid() AND role IN ('superadmin', 'admin'))
);

-- Clients
ALTER TABLE clients ENABLE ROW LEVEL SECURITY;
CREATE POLICY "Clients visibles par admins et rÃ©ception" ON clients FOR SELECT USING (
  EXISTS (SELECT 1 FROM profiles WHERE id = auth.uid() AND role IN ('superadmin', 'admin', 'reception'))
);
CREATE POLICY "Admins et rÃ©ception gÃ¨rent clients" ON clients FOR ALL USING (
  EXISTS (SELECT 1 FROM profiles WHERE id = auth.uid() AND role IN ('superadmin', 'admin', 'reception'))
);

-- Appointments
ALTER TABLE appointments ENABLE ROW LEVEL SECURITY;
CREATE POLICY "Staff voit ses propres RDV" ON appointments FOR SELECT USING (
  staff_id = auth.uid() OR 
  EXISTS (SELECT 1 FROM profiles WHERE id = auth.uid() AND role IN ('superadmin', 'admin', 'reception'))
);
CREATE POLICY "Admins et rÃ©ception gÃ¨rent RDV" ON appointments FOR ALL USING (
  EXISTS (SELECT 1 FROM profiles WHERE id = auth.uid() AND role IN ('superadmin', 'admin', 'reception'))
);
```

### C. InsÃ©rer les donnÃ©es initiales

```sql
-- CatÃ©gories de services
INSERT INTO services_categories (name) VALUES 
('Onglerie'), ('Massage'), ('Hammam'), ('Coiffure'), 
('Maquillage'), ('Soins Visage'), ('Ã‰pilation');

-- Exemples de services (Ã  complÃ©ter selon vos menus)
INSERT INTO services (category_id, name, price, duration) VALUES
(4, 'Brushing Cheveux Courts', 1000, 30),
(4, 'Brushing Cheveux Mi-longs', 1500, 45),
(4, 'Botox Capillaire', 15000, 120),
(4, 'Balayage Cheveux Courts', 15000, 180),
(3, 'Rituel Traditionnel', 2800, 90),
(3, 'Rituel Royal', 3800, 120),
(3, 'Rituel Sultana', 7000, 150),
(1, 'Vernis Semi-Permanent Mains', 3000, 60),
(1, 'Gel Mains', 3500, 75),
(1, 'PÃ©dicure Thuya', 4500, 90),
(2, 'Massage Anti-Stress', 6500, 60),
(2, 'Massage Relaxant', 5000, 60),
(2, 'MadÃ©rothÃ©rapie', 10000, 90),
(6, 'Soin Marin aux 3 Algues', 6000, 60),
(6, 'Hydrafacial Hydraskin CorÃ©en', 15000, 75);
```

### D. CrÃ©er le premier utilisateur Admin
1. Allez dans **Authentication** > **Users**
2. Cliquez **Add user** > **Create new user**
3. Email : `admin@anaros.com`
4. Mot de passe : `AdminAnaros2025!`
5. Confirmez

Puis dans **SQL Editor** :
```sql
INSERT INTO profiles (id, first_name, last_name, role, color_code)
VALUES (
  (SELECT id FROM auth.users WHERE email = 'admin@anaros.com'),
  'Admin',
  'Anaros',
  'superadmin',
  '#FF6B6B'
);
```

---

## ğŸ”‘ Ã‰TAPE 4 : Configuration des Variables d'Environnement

Dans Replit, allez dans **Secrets** (icÃ´ne cadenas) et ajoutez :
- `VITE_SUPABASE_URL` : Votre URL Supabase
- `VITE_SUPABASE_ANON_KEY` : Votre clÃ© anonyme

---

## ğŸ¨ Ã‰TAPE 5 : Personnalisation Finale

Demandez Ã  Replit AI :
```
AmÃ©liore le design avec :
- Palette de couleurs Ã©lÃ©gante (rose poudrÃ© + dorÃ© pour un centre de beautÃ©)
- Animations fluides (framer-motion)
- Loading skeletons pendant les chargements
- Messages de confirmation (toasts)
- Responsive parfait mobile/tablet/desktop
```

---

## ğŸš€ Ã‰TAPE 6 : Lancement

Dans le terminal Replit :
```bash
npm install
npm run dev
```

Votre application sera accessible Ã  l'URL fournie par Replit !

---

## ğŸ“± BONUS : Transformer en PWA

Demandez Ã  Replit AI :
```
Transforme l'application en PWA (Progressive Web App) pour que les employÃ©s puissent l'installer sur leur tÃ©lÃ©phone :
- Ajoute un manifest.json
- Configure le service worker pour le mode offline
- IcÃ´nes de l'app
```

---

## ğŸ†˜ En Cas de ProblÃ¨me

Si Replit AI ne gÃ©nÃ¨re pas bien une partie, vous pouvez :
1. Reformuler le prompt avec plus de dÃ©tails
2. Lui demander de corriger l'erreur spÃ©cifique
3. Me recontacter avec la capture d'Ã©cran de l'erreur

---

## âœ… Checklist de Validation

- [ ] Projet crÃ©Ã© sur Replit avec React + Vite
- [ ] Toutes les dÃ©pendances installÃ©es
- [ ] Supabase configurÃ© et tables crÃ©Ã©es
- [ ] Variables d'environnement ajoutÃ©es
- [ ] Premier admin crÃ©Ã© et peut se connecter
- [ ] Dashboard affiche les KPIs
- [ ] Agenda avec FullCalendar fonctionne
- [ ] Filtrage intelligent des employÃ©s compÃ©tents
- [ ] Vue mobile pour les employÃ©s
- [ ] SystÃ¨me de notifications actif

---

## ğŸ“ Support

En cas de blocage, n'hÃ©sitez pas Ã  me recontacter avec :
- La capture d'Ã©cran de l'erreur
- Le message d'erreur complet
- L'Ã©tape oÃ¹ vous Ãªtes bloquÃ©

Bonne chance pour votre projet Anaros ! ğŸ’…âœ¨